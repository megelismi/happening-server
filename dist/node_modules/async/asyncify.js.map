{"version":3,"sources":["../../../node_modules/async/asyncify.js"],"names":["Object","defineProperty","exports","value","default","asyncify","_isObject","require","_isObject2","_interopRequireDefault","_initialParams","_initialParams2","obj","__esModule","func","args","callback","result","apply","e","then","err","message","Error","module"],"mappings":"AAAA;;AAEAA,OAAOC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AACzCC,WAAO;AADkC,CAA7C;AAGAD,QAAQE,OAAR,GAAkBC,QAAlB;;AAEA,IAAIC,YAAYC,QAAQ,iBAAR,CAAhB;;AAEA,IAAIC,aAAaC,uBAAuBH,SAAvB,CAAjB;;AAEA,IAAII,iBAAiBH,QAAQ,0BAAR,CAArB;;AAEA,IAAII,kBAAkBF,uBAAuBC,cAAvB,CAAtB;;AAEA,SAASD,sBAAT,CAAgCG,GAAhC,EAAqC;AAAE,WAAOA,OAAOA,IAAIC,UAAX,GAAwBD,GAAxB,GAA8B,EAAER,SAASQ,GAAX,EAArC;AAAwD;;AAE/F;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuDA,SAASP,QAAT,CAAkBS,IAAlB,EAAwB;AACpB,WAAO,CAAC,GAAGH,gBAAgBP,OAApB,EAA6B,UAAUW,IAAV,EAAgBC,QAAhB,EAA0B;AAC1D,YAAIC,MAAJ;AACA,YAAI;AACAA,qBAASH,KAAKI,KAAL,CAAW,IAAX,EAAiBH,IAAjB,CAAT;AACH,SAFD,CAEE,OAAOI,CAAP,EAAU;AACR,mBAAOH,SAASG,CAAT,CAAP;AACH;AACD;AACA,YAAI,CAAC,GAAGX,WAAWJ,OAAf,EAAwBa,MAAxB,KAAmC,OAAOA,OAAOG,IAAd,KAAuB,UAA9D,EAA0E;AACtEH,mBAAOG,IAAP,CAAY,UAAUjB,KAAV,EAAiB;AACzBa,yBAAS,IAAT,EAAeb,KAAf;AACH,aAFD,EAEG,UAAUkB,GAAV,EAAe;AACdL,yBAASK,IAAIC,OAAJ,GAAcD,GAAd,GAAoB,IAAIE,KAAJ,CAAUF,GAAV,CAA7B;AACH,aAJD;AAKH,SAND,MAMO;AACHL,qBAAS,IAAT,EAAeC,MAAf;AACH;AACJ,KAjBM,CAAP;AAkBH;AACDO,OAAOtB,OAAP,GAAiBA,QAAQ,SAAR,CAAjB","file":"asyncify.js","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = asyncify;\n\nvar _isObject = require('lodash/isObject');\n\nvar _isObject2 = _interopRequireDefault(_isObject);\n\nvar _initialParams = require('./internal/initialParams');\n\nvar _initialParams2 = _interopRequireDefault(_initialParams);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Take a sync function and make it async, passing its return value to a\n * callback. This is useful for plugging sync functions into a waterfall,\n * series, or other async functions. Any arguments passed to the generated\n * function will be passed to the wrapped function (except for the final\n * callback argument). Errors thrown will be passed to the callback.\n *\n * If the function passed to `asyncify` returns a Promise, that promises's\n * resolved/rejected state will be used to call the callback, rather than simply\n * the synchronous return value.\n *\n * This also means you can asyncify ES2016 `async` functions.\n *\n * @name asyncify\n * @static\n * @memberOf module:Utils\n * @method\n * @alias wrapSync\n * @category Util\n * @param {Function} func - The synchronous function to convert to an\n * asynchronous function.\n * @returns {Function} An asynchronous wrapper of the `func`. To be invoked with\n * (callback).\n * @example\n *\n * // passing a regular synchronous function\n * async.waterfall([\n *     async.apply(fs.readFile, filename, \"utf8\"),\n *     async.asyncify(JSON.parse),\n *     function (data, next) {\n *         // data is the result of parsing the text.\n *         // If there was a parsing error, it would have been caught.\n *     }\n * ], callback);\n *\n * // passing a function returning a promise\n * async.waterfall([\n *     async.apply(fs.readFile, filename, \"utf8\"),\n *     async.asyncify(function (contents) {\n *         return db.model.create(contents);\n *     }),\n *     function (model, next) {\n *         // `model` is the instantiated model object.\n *         // If there was an error, this function would be skipped.\n *     }\n * ], callback);\n *\n * // es6 example\n * var q = async.queue(async.asyncify(async function(file) {\n *     var intermediateStep = await processFile(file);\n *     return await somePromise(intermediateStep)\n * }));\n *\n * q.push(files);\n */\nfunction asyncify(func) {\n    return (0, _initialParams2.default)(function (args, callback) {\n        var result;\n        try {\n            result = func.apply(this, args);\n        } catch (e) {\n            return callback(e);\n        }\n        // if result is Promise object\n        if ((0, _isObject2.default)(result) && typeof result.then === 'function') {\n            result.then(function (value) {\n                callback(null, value);\n            }, function (err) {\n                callback(err.message ? err : new Error(err));\n            });\n        } else {\n            callback(null, result);\n        }\n    });\n}\nmodule.exports = exports['default'];"]}