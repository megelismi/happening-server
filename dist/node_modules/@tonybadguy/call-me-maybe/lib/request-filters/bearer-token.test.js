'use strict';

var _test = require('tap').test;
var _bearerToken = require('./bearer-token');

_test('Sets Authorization header', function (assert) {
  var result = _bearerToken.filter({
    bearerToken: 'my token'
  });

  assert.equals(result.headers.Authorization, 'Bearer my token');
  assert.end();
});

_test('request.bearerToken unchanged', function (assert) {
  var request = {
    bearerToken: 'my token'
  };

  var result = _bearerToken.filter(request);

  assert.equals(request.bearerToken, 'my token');
  assert.end();
});

_test('Overrides existing Authorization header', function (assert) {
  var result = _bearerToken.filter({
    bearerToken: 'my token',
    headers: {
      Authorization: 'original'
    }
  });

  assert.equals(result.headers.Authorization, 'Bearer my token');
  assert.end();
});

_test('Overrides existing Authorization header case insensitive', function (assert) {
  var result = _bearerToken.filter({
    bearerToken: 'my token',
    headers: {
      authorization: 'original'
    }
  });

  assert.equals(result.headers.Authorization, 'Bearer my token');
  assert.equals(result.headers.authorization, undefined);
  assert.end();
});
//# sourceMappingURL=bearer-token.test.js.map